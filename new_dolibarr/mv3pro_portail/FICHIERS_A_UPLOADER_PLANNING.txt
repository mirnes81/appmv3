=====================================================
FICHIERS À UPLOADER - FIX PLANNING VIEW 404
=====================================================

PRIORITÉ : HAUTE - Bloque fonctionnalité Planning

Date : 2026-01-09
Version : 2.1.1

-----------------------------------------------------
FICHIERS À UPLOADER (2 fichiers)
-----------------------------------------------------

SOURCE (dépôt local) :
  /tmp/cc-agent/59302460/project/new_dolibarr/mv3pro_portail/api/v1/planning_view.php
  /tmp/cc-agent/59302460/project/new_dolibarr/mv3pro_portail/api/v1/planning_file.php

DESTINATION (serveur) :
  /path/to/dolibarr/htdocs/custom/mv3pro_portail/api/v1/planning_view.php
  /path/to/dolibarr/htdocs/custom/mv3pro_portail/api/v1/planning_file.php

PERMISSIONS :
  chmod 644 planning_view.php
  chmod 644 planning_file.php

-----------------------------------------------------
MÉTHODE DE DÉPLOIEMENT
-----------------------------------------------------

Option 1 - Via Hoststar File Manager :
  1. Se connecter à Hoststar Control Panel
  2. Ouvrir File Manager
  3. Naviguer vers : htdocs/custom/mv3pro_portail/api/v1/
  4. Uploader les 2 fichiers
  5. Vérifier qu'ils apparaissent dans la liste

Option 2 - Via FTP/SFTP :
  1. Connexion : mv3pro.ch
  2. Path : /path/to/dolibarr/htdocs/custom/mv3pro_portail/api/v1/
  3. Uploader les 2 fichiers
  4. chmod 644 sur les fichiers

-----------------------------------------------------
TESTS DE VALIDATION
-----------------------------------------------------

Test 1 - Existence du fichier (doit retourner 401 au lieu de 404) :
  https://mv3pro.ch/custom/mv3pro_portail/api/v1/planning_view.php

Test 2 - Via PWA :
  1. Ouvrir : https://mv3pro.ch/custom/mv3pro_portail/pwa_dist/
  2. Se connecter
  3. Aller dans Planning
  4. Cliquer sur un événement
  5. Résultat : Page de détail complète s'affiche

Test 3 - Via cURL avec token :
  curl -X GET "https://mv3pro.ch/custom/mv3pro_portail/api/v1/planning_view.php?id=74049" \
    -H "Authorization: Bearer {token}" \
    -H "X-Auth-Token: {token}"

  Résultat attendu : JSON avec toutes les infos de l'événement

-----------------------------------------------------
FONCTIONNALITÉS DÉBLOCÉES APRÈS UPLOAD
-----------------------------------------------------

✅ Voir le détail complet d'un événement (titre, dates, lieu, description)
✅ Voir l'utilisateur assigné
✅ Voir la société/tiers liée
✅ Voir le projet lié
✅ Voir l'objet lié (commande, facture, etc.)
✅ Liste des fichiers joints
✅ Télécharger/ouvrir les fichiers joints (photos, PDF)

-----------------------------------------------------
DOCUMENTATION COMPLÈTE
-----------------------------------------------------

Voir : FIX_PLANNING_VIEW_404.md
  - Détails techniques complets
  - Architecture des endpoints
  - Troubleshooting
  - Tests de validation
  - Checklist complète

-----------------------------------------------------
IMPACT DIAGNOSTIC QA
-----------------------------------------------------

AVANT upload :
  ❌ Planning view → ERROR 404
  ❌ Planning attachments → ERROR 404
  Score Niveau 2 Planning : ~60%

APRÈS upload :
  ✅ Planning view → OK 200
  ✅ Planning attachments → OK 200
  Score Niveau 2 Planning : ~95-100%

-----------------------------------------------------
SUPPORT
-----------------------------------------------------

En cas de problème :
  1. Vérifier les logs : /path/to/dolibarr/documents/mv3pro_portail/debug.log
  2. Vérifier .htaccess : /custom/mv3pro_portail/api/v1/.htaccess
  3. Vérifier permissions : ls -la planning*.php
  4. Consulter FIX_PLANNING_VIEW_404.md section Troubleshooting

=====================================================
