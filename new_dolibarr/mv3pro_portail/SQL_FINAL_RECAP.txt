â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         SQL FINAL MV3 PRO PORTAIL - PRÃŠT POUR PRODUCTION âœ…                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ FICHIER PRINCIPAL
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

   ğŸ“„ sql/mv3pro_portail_install.sql (655 lignes)

   âœ… Script d'installation COMPLET et IDEMPOTENT
   âœ… 20 tables (authentification, rapports, rÃ©gie, frais, matÃ©riel, etc.)
   âœ… Aucun DROP TABLE (sÃ©curitÃ© donnÃ©es)
   âœ… Moteur InnoDB, charset utf8mb4
   âœ… Commentaires dÃ©taillÃ©s
   âœ… Index optimisÃ©s
   âœ… PrÃªt pour production

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š TABLES CRÃ‰Ã‰ES (20 au total)

SECTION 1: AUTHENTIFICATION MOBILE (3 tables)
   âœ“ llx_mv3_mobile_users           - Utilisateurs mobiles avec auth indÃ©pendante
   âœ“ llx_mv3_mobile_sessions        - Sessions actives (tokens JWT)
   âœ“ llx_mv3_mobile_login_history   - Historique des connexions

SECTION 2: RAPPORTS JOURNALIERS (3 tables)
   âœ“ llx_mv3_rapport                - Rapports de chantier + GPS + mÃ©tÃ©o
   âœ“ llx_mv3_rapport_photo          - Photos jointes aux rapports
   âœ“ llx_mv3_signalement            - Signalements et incidents

SECTION 3: SENS DE POSE CARRELAGE (2 tables)
   âœ“ llx_mv3_sens_pose              - Fiches de sens de pose
   âœ“ llx_mv3_sens_pose_pieces       - DÃ©tail multi-piÃ¨ces par fiche

SECTION 4: MATÃ‰RIEL (2 tables)
   âœ“ llx_mv3_materiel               - Gestion outils/machines/vÃ©hicules
   âœ“ llx_mv3_materiel_historique    - TraÃ§abilitÃ© complÃ¨te mouvements

SECTION 5: FEUILLES DE RÃ‰GIE (2 tables)
   âœ“ llx_mv3_regie                  - Bons de rÃ©gie pour facturation
   âœ“ llx_mv3_regie_ligne            - Lignes de dÃ©tail (temps/matÃ©riel)

SECTION 6: NOTES DE FRAIS (1 table)
   âœ“ llx_mv3_frais                  - Notes de frais employÃ©s

SECTION 7: NOTIFICATIONS (1 table)
   âœ“ llx_mv3_notifications          - SystÃ¨me de notifications global

SECTION 8: SOUS-TRAITANTS (6 tables)
   âœ“ llx_mv3_subcontractors         - Gestion sous-traitants
   âœ“ llx_mv3_subcontractor_reports  - Rapports journaliers ST
   âœ“ llx_mv3_subcontractor_photos   - Photos des rapports ST
   âœ“ llx_mv3_subcontractor_payments - Paiements gÃ©nÃ©rÃ©s
   âœ“ llx_mv3_subcontractor_sessions - Sessions mobiles ST
   âœ“ llx_mv3_subcontractor_login_attempts - Protection brute force

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš€ INSTALLATION RAPIDE

   1. Via ligne de commande MySQL:
      mysql -u root -p dolibarr < sql/mv3pro_portail_install.sql

   2. Via phpMyAdmin:
      - SÃ©lectionner base dolibarr
      - Onglet SQL
      - Copier-coller le contenu
      - ExÃ©cuter

   3. VÃ©rifier l'installation:
      mysql -u root -p dolibarr < sql/verify_install.sql

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” VÃ‰RIFICATION POST-INSTALLATION

   Compter les tables:
   SELECT COUNT(*) FROM information_schema.TABLES
   WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME LIKE 'llx_mv3_%';

   RÃ©sultat attendu: 20

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š DOCUMENTATION FOURNIE

   âœ“ mv3pro_portail_install.sql        - Script d'installation complet
   âœ“ INSTRUCTIONS_INSTALLATION.md      - Guide complet pas Ã  pas
   âœ“ verify_install.sql                - Script de vÃ©rification auto
   âœ“ SQL_FINAL_RECAP.txt               - Ce fichier (rÃ©sumÃ©)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ¨ FONCTIONNALITÃ‰S SUPPORTÃ‰ES

   âœ… Login mobile (auth.php)
   âœ… API v1 complÃ¨te (rapports, matÃ©riel, planning, rÃ©gie, frais, etc.)
   âœ… PWA moderne (/pwa_dist/)
   âœ… Protection brute force (5 tentatives max)
   âœ… Sessions avec expiration (30 jours)
   âœ… GPS + MÃ©tÃ©o sur rapports
   âœ… Signatures Ã©lectroniques
   âœ… Gestion multi-entity Dolibarr
   âœ… Historique complet des actions

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ” SÃ‰CURITÃ‰

   âœ“ Password hashing bcrypt
   âœ“ Tokens session sÃ©curisÃ©s (32 bytes hex)
   âœ“ Account locking aprÃ¨s 5 Ã©checs
   âœ“ Session expiration automatique
   âœ“ IP + User-agent tracking
   âœ“ Historique complet des connexions

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš™ï¸ COMPATIBILITÃ‰

   â€¢ Dolibarr >= 16.0
   â€¢ MySQL >= 5.7
   â€¢ MariaDB >= 10.3
   â€¢ PHP >= 7.4
   â€¢ Moteur InnoDB
   â€¢ Charset utf8mb4

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     SQL PRÃŠT POUR PRODUCTION âœ…                               â•‘
â•‘                                                                               â•‘
â•‘   ExÃ©cuter: mysql -u root -p dolibarr < mv3pro_portail_install.sql          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
