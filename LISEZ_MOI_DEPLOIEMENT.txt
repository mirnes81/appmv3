â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… SUPABASE SUPPRIMÃ‰ - L'APP FONCTIONNE 100% AVEC DOLIBARR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ 3 ARCHIVES Ã€ DÃ‰PLOYER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. dolibarr_api_complet.tar.gz (6.6 KB)
   ğŸ“ OÃ¹ : crm.mv-3pro.ch
   ğŸ“‚ Dossier : /var/www/html/dolibarr/custom/mv3pro_portail/api/
   ğŸ“„ Contient : 10 fichiers PHP (auth, forms, etc.)

2. pwa_proxy.tar.gz (1.3 KB)
   ğŸ“ OÃ¹ : app.mv-3pro.ch
   ğŸ“‚ Dossier : /public_html/pro/api/
   ğŸ“„ Contient : index.php + .htaccess

3. pwa_frontend.tar.gz (75 KB)
   ğŸ“ OÃ¹ : app.mv-3pro.ch
   ğŸ“‚ Dossier : /public_html/pro/
   ğŸ“„ Contient : index.html + assets/

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ INSTALLATION RAPIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MÃ‰THODE 1 : SCRIPT AUTOMATIQUE (si vous avez SSH)
--------------------------------------------------
./install.sh

MÃ‰THODE 2 : MANUEL (via FTP/SFTP)
----------------------------------

Ã‰TAPE 1 - API Dolibarr (crm.mv-3pro.ch)
  â†’ Se connecter via FTP
  â†’ Aller dans : /var/www/html/dolibarr/custom/mv3pro_portail/api/
  â†’ Uploader : dolibarr_api_complet.tar.gz
  â†’ DÃ©compresser : tar -xzf dolibarr_api_complet.tar.gz

Ã‰TAPE 2 - Proxy (app.mv-3pro.ch)
  â†’ Se connecter via FTP
  â†’ Aller dans : /public_html/pro/
  â†’ CrÃ©er dossier : api/
  â†’ Uploader dans api/ : pwa_proxy.tar.gz
  â†’ DÃ©compresser : tar -xzf pwa_proxy.tar.gz

Ã‰TAPE 3 - PWA (app.mv-3pro.ch)
  â†’ Aller dans : /public_html/pro/
  â†’ Uploader : pwa_frontend.tar.gz
  â†’ DÃ©compresser : tar -xzf pwa_frontend.tar.gz

Ã‰TAPE 4 - Dossiers uploads (crm.mv-3pro.ch via SSH)
  â†’ mkdir -p /var/www/dolibarr_documents/mv3pro_portail/rapports
  â†’ mkdir -p /var/www/dolibarr_documents/mv3pro_portail/pdf
  â†’ chmod 755 /var/www/dolibarr_documents/mv3pro_portail/*
  â†’ chown -R www-data:www-data /var/www/dolibarr_documents/mv3pro_portail/

Ã‰TAPE 5 - Base de donnÃ©es (si colonnes GPS/mÃ©tÃ©o manquantes)
  â†’ mysql -u root -p dolibarr
  â†’ Source : new_dolibarr/mv3pro_portail/sql/llx_mv3_rapport_add_features.sql

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ª TESTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TEST 1 : Proxy fonctionne
--------------------------
curl https://app.mv-3pro.ch/pro/api/auth_me.php

RÃ‰SULTAT ATTENDU : {"error":"Token requis"}


TEST 2 : Login fonctionne
--------------------------
curl -X POST "https://app.mv-3pro.ch/pro/api/auth_login.php" \
  -H "Content-Type: application/json" \
  -d '{"login":"admin","password":"VOTRE_MOT_DE_PASSE"}'

RÃ‰SULTAT ATTENDU : {"success":true,"token":"...","user":{...}}


TEST 3 : PWA accessible
-----------------------
1. Ouvrir : https://app.mv-3pro.ch/pro/
2. Login : admin (ou votre login Dolibarr)
3. Password : votre mot de passe Dolibarr

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ¨ FONCTIONNALITÃ‰S
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Authentification
   - Login email/password (comptes Dolibarr)
   - Token JWT sÃ©curisÃ© (expire 30 jours)
   - Session persistante

âœ… Rapports de chantier
   - CrÃ©ation avec photos
   - GPS automatique
   - MÃ©tÃ©o automatique
   - MatÃ©riaux utilisÃ©s
   - GÃ©nÃ©ration PDF professionnel
   - Envoi email automatique

âœ… Projets
   - Liste des projets Dolibarr
   - Filtrage par statut

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ—ï¸ ARCHITECTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PWA (app.mv-3pro.ch/pro/)
  â†“ Appels API
Proxy (/pro/api/index.php)
  â†“ Forward HTTP
API Dolibarr (crm.mv-3pro.ch/custom/mv3pro_portail/api/)
  â†“ SQL
Base MySQL (llx_mv3_rapport, llx_mv3_rapport_photo)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“– DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ RECAPITULATIF_DOLIBARR_ONLY.md
   â†’ RÃ©sumÃ© complet de tout ce qui a Ã©tÃ© fait

ğŸ“„ GUIDE_INSTALLATION_DOLIBARR.md
   â†’ Guide technique dÃ©taillÃ© avec troubleshooting

ğŸ“„ README_DEPLOIEMENT_FINAL.txt
   â†’ Instructions complÃ¨tes d'installation

ğŸ“„ install.sh
   â†’ Script d'installation automatique (SSH)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ› PROBLÃˆMES COURANTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ "Token requis"
   â†’ Se reconnecter dans la PWA

âŒ "Identifiants invalides"
   â†’ VÃ©rifier que le compte existe et est actif dans Dolibarr

âŒ "Erreur proxy"
   â†’ tail -f /var/log/apache2/error.log

âŒ Photos ne s'uploadent pas
   â†’ chmod 755 /var/www/dolibarr_documents/mv3pro_portail/rapports

âŒ PDF ne se gÃ©nÃ¨re pas
   â†’ VÃ©rifier TCPDF installÃ© dans Dolibarr

âŒ Email ne part pas
   â†’ Configurer SMTP dans Dolibarr

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… CE QUI A CHANGÃ‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AVANT :
âŒ PWA â†’ Supabase (ne fonctionne pas)
âŒ DonnÃ©es perdues
âŒ CORS problÃ©matique
âŒ NÃ©cessite clÃ© API Supabase

APRÃˆS :
âœ… PWA â†’ Proxy â†’ Dolibarr â†’ MySQL
âœ… DonnÃ©es sauvegardÃ©es dans llx_mv3_rapport
âœ… Photos stockÃ©es dans /documents/
âœ… PDF professionnel
âœ… Email automatique
âœ… Login email/password Dolibarr
âœ… Pas de configuration externe

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ SUPPORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Logs Ã  vÃ©rifier :
  - Apache : tail -f /var/log/apache2/error.log
  - Console navigateur : F12 â†’ Console

Commandes utiles :
  - VÃ©rifier tables : SHOW TABLES LIKE 'llx_mv3_%';
  - Derniers rapports : SELECT * FROM llx_mv3_rapport ORDER BY date_creation DESC LIMIT 5;
  - Users avec API key : SELECT login, api_key FROM llx_user WHERE api_key IS NOT NULL;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Version : 1.0.0
Date : 26 DÃ©cembre 2024
Supabase : SUPPRIMÃ‰ âœ…
Dolibarr : 100% FONCTIONNEL âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
